# EUDI Verifier Endpoint Configuration

# ======================
# Server Configuration
# ======================
HOST=0.0.0.0
PORT=8080
ENV=development
LOG_LEVEL=INFO

# ======================
# Verifier Identity
# ======================
VERIFIER_ORIGINAL_CLIENT_ID=https://verifier.example.com
VERIFIER_CLIENT_ID_PREFIX=pre-registered  # pre-registered, x509_san_dns, or x509_hash
VERIFIER_PUBLIC_URL=https://verifier.example.com
AUTHORIZATION_REQUEST_SCHEME=eudi-openid4vp

# ======================
# JAR (JWT-Secured Authorization Request)
# ======================
# Signing
JAR_SIGNING_KEY_PATH=./security/keystore.jks
JAR_SIGNING_KEY_PASSWORD=changeit
JAR_SIGNING_ALGORITHM=RS256

# Embedding mode
REQUEST_JAR_EMBED=by_reference  # by_value or by_reference
REQUEST_URI_METHOD=get  # get or post

# ======================
# Response Configuration
# ======================
DEFAULT_RESPONSE_MODE=direct_post  # direct_post or direct_post.jwt
MAX_AGE_SECONDS=6400

# Response encryption (for direct_post.jwt)
RESPONSE_ENCRYPTION_ALGORITHM=ECDH-ES
RESPONSE_ENCRYPTION_METHOD=A256GCM

# ======================
# VP Formats Supported
# ======================
# SD-JWT VC
SUPPORTS_SD_JWT_VC=true
SD_JWT_VC_ALGORITHMS=RS256,RS384,RS512,ES256,ES384,ES512
SD_JWT_VC_KB_ALGORITHMS=RS256,ES256

# MSO MDoc
SUPPORTS_MSO_MDOC=true
MSO_MDOC_ISSUER_AUTH_ALGORITHMS=-7,-35,-36  # COSE algorithm IDs
MSO_MDOC_DEVICE_AUTH_ALGORITHMS=-7,-35,-36

# ======================
# Trust Sources
# ======================
# Keystore
TRUST_KEYSTORE_PATH=./security/trusted-issuers.jks
TRUST_KEYSTORE_PASSWORD=changeit
TRUST_KEYSTORE_TYPE=JKS

# LOTL (List of Trusted Lists)
LOTL_ENABLED=false
LOTL_URL=https://ec.europa.eu/tools/lotl/eu-lotl.xml
LOTL_REFRESH_INTERVAL=0 0 * * * *  # Cron expression
LOTL_SERVICE_TYPE_FILTER=PID_PROVIDER

# Trust source patterns (regex â†’ config mapping)
# Format: TRUST_PATTERN_<N>=<regex_pattern>
# TRUST_PATTERN_1=CN=.*,O=Example.*

# ======================
# Validation Configuration
# ======================
# SD-JWT VC
SD_JWT_VC_CHECK_STATUS=true
SD_JWT_VC_VALIDATE_JSON_SCHEMA=true
SD_JWT_VC_TYPE_METADATA_CACHE_TTL=3600
SD_JWT_VC_STATUS_LIST_CACHE_TTL=300

# MSO MDoc
MSO_MDOC_CHECK_VALIDITY_PERIOD=true

# ======================
# Persistence
# ======================
PERSISTENCE_TYPE=in_memory  # in_memory, redis (future)

# For Redis (when implemented)
# REDIS_URL=redis://localhost:6379
# REDIS_PASSWORD=
# REDIS_DB=0

# ======================
# Scheduled Tasks
# ======================
ENABLE_SCHEDULED_TASKS=true
TIMEOUT_CHECK_INTERVAL=*/5 * * * *  # Every 5 minutes
CLEANUP_INTERVAL=0 2 * * *  # Daily at 2 AM
CLEANUP_MAX_AGE_DAYS=7

# ======================
# CORS Configuration
# ======================
CORS_ENABLED=true
CORS_ALLOW_ORIGINS=http://localhost:3000,https://wallet.example.com
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,OPTIONS
CORS_ALLOW_HEADERS=Content-Type,Authorization,Transaction-Id

# ======================
# Transaction Data (RQES)
# ======================
TRANSACTION_DATA_HASH_ALGORITHM=sha-256  # sha-256, sha-384, sha-512

# ======================
# Monitoring & Observability
# ======================
ENABLE_METRICS=false
METRICS_PORT=9090

# Structured logging
LOG_FORMAT=json  # json or text
LOG_INCLUDE_TIMESTAMP=true

# ======================
# Development
# ======================
# Set to true to enable debug mode (more verbose logging, stack traces in responses)
DEBUG=false

# Reload on code changes (uvicorn --reload)
AUTO_RELOAD=true

# ======================
# Security
# ======================
# Rate limiting (requests per minute per IP)
RATE_LIMIT_ENABLED=false
RATE_LIMIT_REQUESTS_PER_MINUTE=60

# Request size limits
MAX_REQUEST_SIZE_MB=10
